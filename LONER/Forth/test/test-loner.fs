REQUIRE ffl/tst.fs
REQUIRE parser.fs
REQUIRE loner.fs

." TEST-LONER" CR
T{ ." can parse a simple pattern" CR
    S" 1" LONER? ?TRUE
    S" " LONER? ?FALSE
}T 

T{ ." can parse a simple pattern surrounded with zeroes" CR
    S" 000010000" LONER? ?TRUE
    S" 000000000" LONER? ?FALSE
    S" 00010000100" LONER? ?FALSE
}T

T{ ." can parse several simple patterns" CR
    S" 110" LONER? ?TRUE
    S" 1101" LONER? ?TRUE
    S" 11111101" LONER? ?TRUE
    S" 11010101" LONER? ?TRUE
    S" 1101010111111101" LONER? ?TRUE
    S" 110010101011" LONER? ?TRUE
    S" 1100111111" LONER? ?TRUE
    S" 110011111110101011" LONER? ?TRUE
    S" 110101010011" LONER? ?TRUE
    S" 110101010010101011" LONER? ?TRUE
    S" 110101010011111111" LONER? ?TRUE
    S" 1101010100111111101011" LONER? ?TRUE
}T
BYE

T{ ." can parse zeroes" CR
    S" 000001" ZEROES EXECUTE ?TRUE S" 1" ?STR
}T

T{ ." can parse complex patterns" CR
    S" 1101" LONER-C EXECUTE ?TRUE S" " ?STR
    S" 110101111101" LONER-D EXECUTE ?TRUE 2DROP
    S" 11011101" LONER-D EXECUTE ?TRUE 2DROP
    S" 1101011101" LONER-D EXECUTE ?TRUE 2DROP
    S" 111101" LONER-D EXECUTE ?TRUE 2DROP
    S" 1111111101" LONER-D EXECUTE ?TRUE 2DROP
}T
T{ ." can parse a big complex pattern" CR
    S" 1101010100111111101011" LONER-ALL EXECUTE ?TRUE 2DROP
    S" 11010101110111111111101011" LONER-ALL EXECUTE ?TRUE 2DROP
    S" 110" LONER-ALL EXECUTE ?TRUE TYPE
    S" 110" LONER-ALL  EXECUTE ?TRUE TYPE
    S" 110101" LONER-ALL EXECUTE ?TRUE 2DROP
    S" 110101" LONER-ALL EXECUTE ?TRUE 2DROP
}T
T{  ." can solve the problem" CR
   S" 0110101010101010101010101010101010101010101010111111011101010110" LONER? ?FALSE
   S" 00110101010101010101010111111011101010101010101010101010101010101010101100000" LONER? ?FALSE
   S" 00000000000000000000000000001101010101010101010101010101010101010101010110111010101010101010101010101010101100" LONER? ?FALSE
   S" 00101010110" LONER? ?FALSE
    S" 00000001101" LONER? ?TRUE
    S" 0" LONER? ?FALSE
    S" 00000000000000" LONER? ?FALSE
    S" 1" LONER? ?TRUE
    S" 10" LONER? ?TRUE
    S" 01" LONER? ?TRUE
    S" 011" LONER? ?TRUE
    S" 10001" LONER? ?FALSE
    S" 1001" LONER? ?FALSE
    S" 101" LONER? ?FALSE
    S" 110101" LONER? ?TRUE
    S" 01010110" LONER? ?TRUE
    S" 110011" LONER? ?TRUE
    S" 11001" LONER? ?FALSE
}T


