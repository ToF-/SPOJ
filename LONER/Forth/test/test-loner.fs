REQUIRE ffl/tst.fs
REQUIRE parser.fs
REQUIRE loner.fs

." TEST-LONER" CR
T{ ." can parse a simple pattern" CR
    S" 1" LONER-A EXECUTE ?TRUE S" " ?STR
    S" 0" LONER-A EXECUTE ?FALSE S" 0" ?STR
    S" 110" LONER-B EXECUTE ?TRUE S" " ?STR
    S" 111" LONER-B EXECUTE ?FALSE S" 111" ?STR
}T 

T{ ." can parse zeroes" CR
    S" 000001" ZEROES EXECUTE ?TRUE S" 1" ?STR
}T

T{ ." can parse complex patterns" CR
    S" 1101" LONER-C EXECUTE ?TRUE S" " ?STR
    S" 110101111101" LONER-D EXECUTE ?TRUE 2DROP
    S" 11011101" LONER-D EXECUTE ?TRUE 2DROP
    S" 1101011101" LONER-D EXECUTE ?TRUE 2DROP
    S" 111101" LONER-D EXECUTE ?TRUE 2DROP
    S" 1111111101" LONER-D EXECUTE ?TRUE 2DROP

    S" 1101010100111111101011" LONER-E EXECUTE ?TRUE 2DROP
    S" 11010101110111111111101011" LONER-F EXECUTE ?TRUE 2DROP
}T

T{ ." can parse the loner pattern" CR
    S" 00000000111101000000" LONER EXECUTE ?TRUE 2DROP
    S" 0110011" LONER EXECUTE ?TRUE 2DROP
    S" 111001" LONER EXECUTE ?FALSE 2DROP
}T
BYE

T{ ." can parse the board" CR
    S" 000001000" LONER ?TRUE S" " ?STR
    S" 000000000000000110000000000" LONER ?TRUE S" " ?STR
    S" 1" LONER ?TRUE 2DROP
    S" 0" LONER ?FALSE 2DROP
    S" 110" LONER ?TRUE 2DROP
    S" 110000" LONER ?TRUE 2DROP
}T

