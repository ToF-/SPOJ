REQUIRE ffl/tst.fs
REQUIRE parser.fs
REQUIRE loner.fs

." TEST-LONER" CR
T{ ." can parse a simple pattern" CR
    S" 1" LONER? ?TRUE
    S" " LONER? ?FALSE
}T 

T{ ." can parse a simple pattern surrounded with zeroes" CR
    S" 000010000" LONER? ?TRUE
    S" 000000000" LONER? ?FALSE
    S" 00010000100" LONER? ?FALSE
}T

T{ ." can parse several simple patterns" CR
    S" 110" LONER? ?TRUE
    S" 1101" LONER? ?TRUE
    S" 11111101" LONER? ?TRUE
    S" 11010101" LONER? ?TRUE
    S" 1101010111111101" LONER? ?TRUE
    S" 110010101011" LONER? ?TRUE
    S" 1100111111" LONER? ?TRUE
    S" 110011111110101011" LONER? ?TRUE
    S" 110101010011" LONER? ?TRUE
    S" 110101010010101011" LONER? ?TRUE
    S" 110101010011111111" LONER? ?TRUE
    S" 1101010100111111101011" LONER? ?TRUE
    S" 11110110101011" LONER? ?TRUE
    S" 11110111111111" LONER? ?TRUE
    S" 11110111111110101011" LONER? ?TRUE
    S" 11010101110111" LONER? ?TRUE
    S" 11010101110110101011" LONER? ?TRUE
    S" 1101010101110111111111" LONER? ?TRUE
    S" 11010101110111111110101011" LONER? ?TRUE
    S" 11100111" LONER? TRUE
}T
T{ ." can reverse a string" CR
    S" xuqraboof" 2DUP REVERSE S" foobarqux" ?STR
    S" barc" 2DUP REVERSE S" crab" ?STR
}T

T{ ." can parse the reverse of the source string" CR
    S" 011" LONER? ?TRUE
    S" 1011" LONER? ?TRUE
}T

