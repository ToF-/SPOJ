#! /usr/local/bin/gforth
\ launch with one argument to avoid executing main function : ./testjednakos test
PAGE
REQUIRE ffl/tst.fs
REQUIRE jednakos.fs

DEBUG ON
TEST ON
T{ ." DIGITS-LENGTH finds the position on the equal sign in the input " CR
    S" 123456789=123" DIGITS-LENGTH 9 ?S 
    S" Whatever can be in that string anyway = voila" DIGITS-LENGTH 38 ?S 
    S" only count the first = not any other = " DIGITS-LENGTH 21 ?S 
}T

T{ ." >DIGITS! stores the digits before equal sign an array " CR
    S" 123456789=123" DROP 9 >DIGITS!
    DIGITS 0 + C@ 1 ?S
    DIGITS 1 + C@ 2 ?S
    DIGITS 2 + C@ 3 ?S
}T

T{ ." >DIGITS>SUM! stores the digits in an array and the sum that is after the equal sign " CR
    S" 143175=120" >DIGITS>SUM! 
    DIGITS 0 + C@ 1 ?S
    DIGITS 1 + C@ 4 ?S
    DIGITS 2 + C@ 3 ?S
    DIGITS 3 + C@ 1 ?S
    DIGITS 4 + C@ 7 ?S
    DIGITS 5 + C@ 5 ?S
    SUM @ 120 ?S
}T

T{ ." T! and T@ stores and fetches a word at a row and column of the table " CR
    50 SUM !  5 N !
    INIT-TABLE
    4807 2 17 T!
    42   3 18 T!
    3 18 T@ 42   ?S
    2 17 T@ 4807 ?S
    FREE-TABLE
}T

T{ ." PARTITION-PLUS returns X if result < 0 " CR
    42 -4807 PARTITION-PLUS X ?S 
}T

T{ ." PARTITION-PLUS returns X if result <> 0 and i == N " CR
    S" 1234=28" >DIGITS>SUM!
    4 32 PARTITION-PLUS X ?S 
}T

T{ ." PARTITION-PLUS returns 0 if result = 0 and i == N " CR
    S" 1234=28" >DIGITS>SUM!
    4 0 PARTITION-PLUS 0 ?S 
}T
 
T{ ." PARTITION-PLUS return T[i][r] if is not Z " CR
    50 SUM !  5 N !
    INIT-TABLE
    42 2 18 T!
    2 18 PARTITION-PLUS 42 ?S
    FREE-TABLE

}T
T{ ." PARTITION-PLUS calls itself while substracting result " CR
    S" 5=5" >DIGITS>SUM!
    INIT-TABLE
    0 5 PARTITION-PLUS 1- 0 ?S
    FREE-TABLE

    S" 51=51" >DIGITS>SUM!
    INIT-TABLE
    0 51 PARTITION-PLUS 1- 0 ?S
    FREE-TABLE

    S" 51=6" >DIGITS>SUM!
    INIT-TABLE
    0 6 PARTITION-PLUS 1- 1 ?S
    FREE-TABLE

    S" 510=15" >DIGITS>SUM!
    INIT-TABLE
    0 15 PARTITION-PLUS 1- 1 ?S
    FREE-TABLE

    S" 501=6" >DIGITS>SUM!
    INIT-TABLE
    0 6 PARTITION-PLUS 1- 1 ?S
    FREE-TABLE
}T

T{ ." PLUSSES finds the number of additions in a jednakos equation " CR
    S" 42=42"      PLUSSES 0 ?S
    S" 51=6"       PLUSSES 1 ?S
    S" 143175=120" PLUSSES 2 ?S
    S" 999899=125" PLUSSES 4 ?S
    S" 5025=30"    PLUSSES 1 ?S
    S" 49511917553=50" PLUSSES 10 ?S
    S" 49511917553=5000" PLUSSES 5 ?S
S" 3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333=3000"
    PLUSSES  999 ?S

}T
    
BYE
