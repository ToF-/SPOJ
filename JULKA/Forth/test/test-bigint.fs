REQUIRE ffl/tst.fs
REQUIRE bigint.fs

CREATE BN-A BN-SIZE ALLOT
CREATE BN-X BN-SIZE ALLOT
CREATE BN-Y BN-SIZE ALLOT

." TEST BIGINT" CR
HEX
T{
    ." adding 2 dcbs " CR
    19 24 DCB+ 43 ?S 0 ?S
    19 19 DCB+ 38 ?S 0 ?S
    15 15 DCB+ 30 ?S 0 ?S
    90 09 DCB+ 99 ?S 0 ?S
    90 10 DCB+ 00 ?S 1 ?S
    99 99 DCB+ 98 ?S 1 ?S
}T
T{
    ." subtracting 2 dcbs" CR
    24 19 DCB- 5 ?S 0 ?S
    19 24 DCB- 95 ?S 1 ?S
    00 99 DCB-  1 ?S 1 ?S
    99 00 DCB- 99 ?S 0 ?S 
    00 98 DCB-  2 ?S 1 ?S
    10 95 DCB- 15 ?S 1 ?S
    00 50 DCB- 50 ?S 1 ?S
}T
T{
    ." halving a dcb " CR
    0 24 DCB2/ 12 ?S 0 ?S
    0 75 DCB2/ 37 ?S 1 ?S
    0 00 DCB2/ 0  ?S 0 ?S
    0 99 DCB2/ 49 ?S 1 ?S
    1 00 DCB2/ 50 ?S 0 ?S
    1 99 DCB2/ 99 ?S 1 ?S
}T

T{
    ." converting a string to dcb number and back" CR
    S" 4807" BN-A STR>BN
    BN-A BN>STR S" 4807" ?STR
    S" 0" BN-A STR>BN
    BN-A BN>STR S" 0" ?STR
    S" 329" BN-A STR>BN
    BN-A BN>STR S" 329" ?STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-A STR>BN
    BN-A BN>STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" ?STR
}T

T{
    ." adding 2 dcb numbers" CR
    S" 4807" BN-X STR>BN
    S" 2317" BN-Y STR>BN
    BN-X BN-Y BN-A BN+
    BN-A BN>STR S" 7124" ?STR
    S" 328074807" BN-X STR>BN
    S" 12317"     BN-Y STR>BN
    BN-X BN-Y BN-A BN+
    BN-A BN>STR S" 328087124" ?STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-X STR>BN
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-Y STR>BN
    BN-X BN-Y BN-A BN+
    BN-A BN>STR
    S" 2469135780246913578024691357802469135780246913578024691357802469135780246913578024691357802469135780" ?STR
}T
T{
    ." subtracting 2 dcb numbers" CR
    S" 100" BN-X STR>BN
    S" 46"  BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR S" 54" ?STR
    S" 4807" BN-X STR>BN
    S" 99"  BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR S" 4708" ?STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-X STR>BN
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR
    S" 0" ?STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891" BN-X STR>BN
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR
    S" 1" ?STR
    S" 5" BN-X STR>BN
    S" 7" BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR
    S" 1" ?STR
}T
T{
    ." halving a dcb number" CR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-X STR>BN
    BN-X BN-Y BN2/
    BN-Y BN>STR
    S" 617283945061728394506172839450617283945061728394506172839450617283945061728394506172839450617283945" ?STR
}T
