REQUIRE ffl/tst.fs
REQUIRE bigint.fs

CREATE BN-A BN-SIZE ALLOT
CREATE BN-X BN-SIZE ALLOT
CREATE BN-Y BN-SIZE ALLOT

." TEST BIGINT" CR
HEX
T{
    ." adding 2 dcbs + carry" CR
    01 01 0 DCB+C 0 ?S 02 ?S
    01 01 1 DCB+C 0 ?S 03 ?S
    01 09 0 DCB+C 0 ?S 10 ?S
    01 09 1 DCB+C 0 ?S 11 ?S
    09 09 0 DCB+C 0 ?S 18 ?S
    00 99 1 DCB+C 1 ?S 00 ?S
    99 99 0 DCB+C 1 ?S 98 ?S
    99 99 1 DCB+C 1 ?S 99 ?S
}T
T{
    ." subtracting 2 dcbs" CR
    24 19 0 DCB-C  0 ?S  5 ?S
    19 24 0 DCB-C  1 ?S 95 ?S
    00 99 0 DCB-C  1 ?S  1 ?S
    99 00 0 DCB-C  0 ?S 99 ?S
    00 98 0 DCB-C  1 ?S  2 ?S
    10 95 0 DCB-C  1 ?S 15 ?S
    00 50 0 DCB-C  1 ?S 50 ?S
    00 50 1 DCB-C  1 ?S 49 ?S
    99 99 0 DCB-C  0 ?S 00 ?S
    00 99 1 DCB-C  1 ?S 00 ?S
    99 99 1 DCB-C  1 ?S 99 ?S
}T
T{
    ." halving a dcb " CR
    24 0 DCB2/C  0 ?S 12 ?S
    24 1 DCB2/C  0 ?S 62 ?S
    25 1 DCB2/C  1 ?S 62 ?S
    25 0 DCB2/C  1 ?S 12 ?S 
    00 1 DCB2/C  0 ?S 50 ?S
}T

T{
    ." converting a string to dcb number and back" CR
    S" 4807" BN-A STR>BN
    BN-A BN>STR S" 4807" ?STR
    S" 0" BN-A STR>BN
    BN-A BN>STR S" 0" ?STR
    S" 329" BN-A STR>BN
    BN-A BN>STR S" 329" ?STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-A STR>BN
    BN-A BN>STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" ?STR
}T

T{
    ." adding 2 dcb numbers" CR
    S" 4807" BN-X STR>BN
    S" 2317" BN-Y STR>BN
    BN-X BN-Y BN-A BN+
    BN-A BN>STR S" 7124" ?STR
    S" 328074807" BN-X STR>BN
    S" 12317"     BN-Y STR>BN
    BN-X BN-Y BN-A BN+
    BN-A BN>STR S" 328087124" ?STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-X STR>BN
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-Y STR>BN
    BN-X BN-Y BN-A BN+
    BN-A BN>STR
    S" 2469135780246913578024691357802469135780246913578024691357802469135780246913578024691357802469135780" ?STR
}T
T{
    ." subtracting 2 dcb numbers" CR
    S" 100" BN-X STR>BN
    S" 46"  BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR S" 54" ?STR
    S" 4807" BN-X STR>BN
    S" 99"  BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR S" 4708" ?STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-X STR>BN
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR
    S" 0" ?STR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891" BN-X STR>BN
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR
    S" 1" ?STR
    S" 5" BN-X STR>BN
    S" 7" BN-Y STR>BN
    BN-X BN-Y BN-A BN-
    BN-A BN>STR
    S" 99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999998" ?STR
}T
T{
    ." halving a dcb number" CR
    S" 4807" BN-X STR>BN
    BN-X BN-Y BN2/
    BN-Y BN>STR S" 2403" ?STR

    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BN-X STR>BN
    BN-X BN-Y BN2/
    BN-Y BN>STR
    S" 617283945061728394506172839450617283945061728394506172839450617283945061728394506172839450617283945" ?STR
}T
