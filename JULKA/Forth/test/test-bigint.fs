REQUIRE ffl/tst.fs
REQUIRE bigint.fs

." TEST BIGINT" CR
T{
    ." adding 2 dcbs " CR
    HEX
    19 24 DCB+ 43 ?S 0 ?S
    19 19 DCB+ 38 ?S 0 ?S
    15 15 DCB+ 30 ?S 0 ?S
    90 09 DCB+ 99 ?S 0 ?S
    90 10 DCB+ 00 ?S 1 ?S
    99 99 DCB+ 98 ?S 1 ?S
    DECIMAL
}T
T{
    ." halving a dcb " CR
    HEX
    24 DCB2/ 12 ?S 0 ?S
    75 DCB2/ 37 ?S 1 ?S
    00 DCB2/ 0  ?S 0 ?S
    99 DCB2/ 49 ?S 1 ?S
}T
BYE
T{
    ." converting a byte to dcb" CR
    HEX
    FF >DCB 55 ?S 02 ?S
    A9 >DCB 69 ?S 01 ?S
    2A >DCB 42 ?S 00 ?S
    DECIMAL
}T
T{ 
    ." converting a dcb to byte" CR
    HEX
    55 DCB> 37 ?S
    69 DCB> 45 ?S
    17 DCB> 11 ?S
    47 DCB> 2F ?S
    28 DCB> 1C ?S
    55 DCB> 37 ?S
    DECIMAL
}T
T{
    ." converting a string to dcb number" CR
    HEX
    S" 4807" BIG-A STR>BIG
    BIG-A BIG-SIZE DUMP
    S" 329" BIG-A STR>BIG
    BIG-A BIG-SIZE DUMP
    DECIMAL
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BIG-A STR>BIG
    BIG-A BIG-SIZE DUMP
}T

T{
    ." halving a dcb" CR
    HEX
    48 DCB2/MOD 24 ?S 0 ?S
    17 DCB2/MOD 08 ?S 1 ?S
    99 DCB2/MOD 49 ?S 1 ?S 
    DECIMAL
}T

T{
    ." halving a big int" CR
    S" 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890" BIG-X STR>BIG
    BIG-X BIGINT/2
    S" 617283945061728394506172839450617283945061728394506172839450617283945061728394506172839450617283945" BIG-Y STR>BIG
    BIG-X BIG-Y BIGINT-COMPARE 0 ?S
}T
